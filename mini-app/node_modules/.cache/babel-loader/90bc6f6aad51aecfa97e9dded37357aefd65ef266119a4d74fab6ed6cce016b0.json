{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"shouldDisableDate\", \"disableFuture\", \"disablePast\", \"value\", \"onChange\", \"calendarPlacement\", \"style\", \"className\", \"closeOnChange\", \"disablePickers\", \"getRootRef\", \"name\", \"autoFocus\", \"disabled\", \"onClick\", \"onFocus\", \"prevMonthAriaLabel\", \"nextMonthAriaLabel\", \"changeDayAriaLabel\", \"changeMonthAriaLabel\", \"changeYearAriaLabel\", \"changeStartDayAriaLabel\", \"changeStartMonthAriaLabel\", \"changeStartYearAriaLabel\", \"changeEndDayAriaLabel\", \"changeEndMonthAriaLabel\", \"changeEndYearAriaLabel\", \"clearFieldAriaLabel\", \"showCalendarAriaLabel\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport { format, isMatch, parse, isAfter } from \"date-fns\";\nimport { Icon16Clear, Icon20CalendarOutline } from \"@vkontakte/icons\";\nimport { CalendarRange } from \"../CalendarRange/CalendarRange\";\nimport { Popper } from \"../Popper/Popper\";\nimport IconButton from \"../IconButton/IconButton\";\nimport { useDateInput } from \"../../hooks/useDateInput\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { classNames } from \"../../lib/classNames\";\nimport { multiRef } from \"../../lib/utils\";\nimport { FormField } from \"../FormField/FormField\";\nimport { InputLike } from \"../InputLike/InputLike\";\nimport { InputLikeDivider } from \"../InputLike/InputLikeDivider\";\nimport { callMultiple } from \"../../lib/callMultiple\";\nvar elementsConfig = function elementsConfig(index) {\n  var length = 2;\n  var min = 1;\n  var max = 0;\n  switch (index) {\n    case 0:\n    case 3:\n      max = 31;\n      break;\n    case 1:\n    case 4:\n      max = 12;\n      break;\n    case 2:\n    case 5:\n      max = 2100;\n      min = 1900;\n      length = 4;\n      break;\n  }\n  return {\n    length: length,\n    min: min,\n    max: max\n  };\n};\nvar getInternalValue = function getInternalValue(value) {\n  var newValue = [\"\", \"\", \"\", \"\", \"\", \"\"];\n  if (value !== null && value !== void 0 && value[0]) {\n    newValue[0] = String(value[0].getDate()).padStart(2, \"0\");\n    newValue[1] = String(value[0].getMonth() + 1).padStart(2, \"0\");\n    newValue[2] = String(value[0].getFullYear()).padStart(4, \"0\");\n  }\n  if (value !== null && value !== void 0 && value[1]) {\n    newValue[3] = String(value[1].getDate()).padStart(2, \"0\");\n    newValue[4] = String(value[1].getMonth() + 1).padStart(2, \"0\");\n    newValue[5] = String(value[1].getFullYear()).padStart(4, \"0\");\n  }\n  return newValue;\n};\nexport var DateRangeInput = function DateRangeInput(_ref) {\n  var shouldDisableDate = _ref.shouldDisableDate,\n    disableFuture = _ref.disableFuture,\n    disablePast = _ref.disablePast,\n    value = _ref.value,\n    onChange = _ref.onChange,\n    _ref$calendarPlacemen = _ref.calendarPlacement,\n    calendarPlacement = _ref$calendarPlacemen === void 0 ? \"bottom-start\" : _ref$calendarPlacemen,\n    style = _ref.style,\n    className = _ref.className,\n    _ref$closeOnChange = _ref.closeOnChange,\n    closeOnChange = _ref$closeOnChange === void 0 ? true : _ref$closeOnChange,\n    disablePickers = _ref.disablePickers,\n    getRootRef = _ref.getRootRef,\n    name = _ref.name,\n    autoFocus = _ref.autoFocus,\n    disabled = _ref.disabled,\n    onClick = _ref.onClick,\n    onFocus = _ref.onFocus,\n    prevMonthAriaLabel = _ref.prevMonthAriaLabel,\n    nextMonthAriaLabel = _ref.nextMonthAriaLabel,\n    changeDayAriaLabel = _ref.changeDayAriaLabel,\n    changeMonthAriaLabel = _ref.changeMonthAriaLabel,\n    changeYearAriaLabel = _ref.changeYearAriaLabel,\n    _ref$changeStartDayAr = _ref.changeStartDayAriaLabel,\n    changeStartDayAriaLabel = _ref$changeStartDayAr === void 0 ? \"Изменить день начала\" : _ref$changeStartDayAr,\n    _ref$changeStartMonth = _ref.changeStartMonthAriaLabel,\n    changeStartMonthAriaLabel = _ref$changeStartMonth === void 0 ? \"Изменить месяц начала\" : _ref$changeStartMonth,\n    _ref$changeStartYearA = _ref.changeStartYearAriaLabel,\n    changeStartYearAriaLabel = _ref$changeStartYearA === void 0 ? \"Изменить год начала\" : _ref$changeStartYearA,\n    _ref$changeEndDayAria = _ref.changeEndDayAriaLabel,\n    changeEndDayAriaLabel = _ref$changeEndDayAria === void 0 ? \"Изменить день окончания\" : _ref$changeEndDayAria,\n    _ref$changeEndMonthAr = _ref.changeEndMonthAriaLabel,\n    changeEndMonthAriaLabel = _ref$changeEndMonthAr === void 0 ? \"Изменить месяц окончания\" : _ref$changeEndMonthAr,\n    _ref$changeEndYearAri = _ref.changeEndYearAriaLabel,\n    changeEndYearAriaLabel = _ref$changeEndYearAri === void 0 ? \"Изменить год окончания\" : _ref$changeEndYearAri,\n    _ref$clearFieldAriaLa = _ref.clearFieldAriaLabel,\n    clearFieldAriaLabel = _ref$clearFieldAriaLa === void 0 ? \"Очистить поле\" : _ref$clearFieldAriaLa,\n    _ref$showCalendarAria = _ref.showCalendarAriaLabel,\n    showCalendarAriaLabel = _ref$showCalendarAria === void 0 ? \"Показать календарь\" : _ref$showCalendarAria,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var daysStartRef = React.useRef(null);\n  var monthsStartRef = React.useRef(null);\n  var yearsStartRef = React.useRef(null);\n  var daysEndRef = React.useRef(null);\n  var monthsEndRef = React.useRef(null);\n  var yearsEndRef = React.useRef(null);\n  var onInternalValueChange = React.useCallback(function (internalValue) {\n    var isStartValid = true;\n    var isEndValid = true;\n    for (var i = 0; i <= 2; i += 1) {\n      if (internalValue[i].length < elementsConfig(i).length) {\n        isStartValid = false;\n      }\n    }\n    for (var _i = 3; _i <= 5; _i += 1) {\n      if (internalValue[_i].length < elementsConfig(_i).length) {\n        isEndValid = false;\n      }\n    }\n    var formattedStartValue = \"\".concat(internalValue[0], \".\").concat(internalValue[1], \".\").concat(internalValue[2]);\n    var formattedEndValue = \"\".concat(internalValue[3], \".\").concat(internalValue[4], \".\").concat(internalValue[5]);\n    var mask = \"dd.MM.yyyy\";\n    if (!isMatch(formattedStartValue, mask)) {\n      isStartValid = false;\n    }\n    if (!isMatch(formattedEndValue, mask)) {\n      isEndValid = false;\n    }\n    if (!isStartValid && !isEndValid) {\n      return;\n    }\n    var valueExists = Array.isArray(value);\n    var now = new Date();\n    var start = isStartValid ? parse(formattedStartValue, mask, valueExists && (value === null || value === void 0 ? void 0 : value[0]) || now) : null;\n    var end = isEndValid ? parse(formattedEndValue, mask, valueExists && (value === null || value === void 0 ? void 0 : value[1]) || now) : null;\n    if (start && end && isAfter(end, start)) {\n      onChange === null || onChange === void 0 ? void 0 : onChange([start, end]);\n    }\n  }, [onChange, value]);\n  var refs = React.useMemo(function () {\n    return [daysStartRef, monthsStartRef, yearsStartRef, daysEndRef, monthsEndRef, yearsEndRef];\n  }, [daysStartRef, monthsStartRef, yearsStartRef, daysEndRef, monthsEndRef, yearsEndRef]);\n  var _useDateInput = useDateInput({\n      maxElement: 5,\n      refs: refs,\n      autoFocus: autoFocus,\n      disabled: disabled,\n      elementsConfig: elementsConfig,\n      onChange: onChange,\n      onInternalValueChange: onInternalValueChange,\n      getInternalValue: getInternalValue,\n      value: value\n    }),\n    rootRef = _useDateInput.rootRef,\n    calendarRef = _useDateInput.calendarRef,\n    open = _useDateInput.open,\n    openCalendar = _useDateInput.openCalendar,\n    closeCalendar = _useDateInput.closeCalendar,\n    internalValue = _useDateInput.internalValue,\n    handleKeyDown = _useDateInput.handleKeyDown,\n    setFocusedElement = _useDateInput.setFocusedElement,\n    handleFieldEnter = _useDateInput.handleFieldEnter,\n    clear = _useDateInput.clear,\n    removeFocusFromField = _useDateInput.removeFocusFromField;\n  var _useAdaptivity = useAdaptivity(),\n    sizeY = _useAdaptivity.sizeY;\n  var onCalendarChange = React.useCallback(function (newValue) {\n    onChange === null || onChange === void 0 ? void 0 : onChange(newValue);\n    if (closeOnChange && newValue !== null && newValue !== void 0 && newValue[1] && newValue[1] !== (value === null || value === void 0 ? void 0 : value[1])) {\n      removeFocusFromField();\n    }\n  }, [onChange, closeOnChange, value, removeFocusFromField]);\n  return createScopedElement(FormField, _extends({\n    vkuiClass: classNames(\"DateRangeInput\", \"DateRangeInput--sizeY-\".concat(sizeY)),\n    style: style,\n    className: className,\n    getRootRef: multiRef(rootRef, getRootRef),\n    after: value ? createScopedElement(IconButton, {\n      hoverMode: \"opacity\",\n      \"aria-label\": clearFieldAriaLabel,\n      onClick: clear\n    }, createScopedElement(Icon16Clear, null)) : createScopedElement(IconButton, {\n      hoverMode: \"opacity\",\n      \"aria-label\": showCalendarAriaLabel,\n      onClick: openCalendar\n    }, createScopedElement(Icon20CalendarOutline, null)),\n    disabled: disabled,\n    onClick: callMultiple(handleFieldEnter, onClick),\n    onFocus: callMultiple(handleFieldEnter, onFocus)\n  }, props), createScopedElement(\"input\", {\n    type: \"hidden\",\n    name: name,\n    value: value ? \"\".concat(value[0] ? format(value[0], \"dd.MM.yyyy\") : \"\", \" - \").concat(value[1] ? format(value[1], \"dd.MM.yyyy\") : \"\") : \"\"\n  }), createScopedElement(\"span\", {\n    vkuiClass: \"DateInput__input\",\n    onKeyDown: handleKeyDown\n  }, createScopedElement(InputLike, {\n    length: 2,\n    getRootRef: daysStartRef,\n    index: 0,\n    onElementSelect: setFocusedElement,\n    value: internalValue[0],\n    \"aria-label\": changeStartDayAriaLabel\n  }), createScopedElement(InputLikeDivider, null, \".\"), createScopedElement(InputLike, {\n    length: 2,\n    getRootRef: monthsStartRef,\n    index: 1,\n    onElementSelect: setFocusedElement,\n    value: internalValue[1],\n    \"aria-label\": changeStartMonthAriaLabel\n  }), createScopedElement(InputLikeDivider, null, \".\"), createScopedElement(InputLike, {\n    length: 4,\n    getRootRef: yearsStartRef,\n    index: 2,\n    onElementSelect: setFocusedElement,\n    value: internalValue[2],\n    \"aria-label\": changeStartYearAriaLabel\n  }), createScopedElement(InputLikeDivider, null, \" — \"), createScopedElement(InputLike, {\n    length: 2,\n    getRootRef: daysEndRef,\n    index: 3,\n    onElementSelect: setFocusedElement,\n    value: internalValue[3],\n    \"aria-label\": changeEndDayAriaLabel\n  }), createScopedElement(InputLikeDivider, null, \".\"), createScopedElement(InputLike, {\n    length: 2,\n    getRootRef: monthsEndRef,\n    index: 4,\n    onElementSelect: setFocusedElement,\n    value: internalValue[4],\n    \"aria-label\": changeEndMonthAriaLabel\n  }), createScopedElement(InputLikeDivider, null, \".\"), createScopedElement(InputLike, {\n    length: 4,\n    getRootRef: yearsEndRef,\n    index: 5,\n    onElementSelect: setFocusedElement,\n    value: internalValue[5],\n    \"aria-label\": changeEndYearAriaLabel\n  })), open && createScopedElement(Popper, {\n    targetRef: rootRef,\n    offsetDistance: 8,\n    placement: calendarPlacement\n  }, createScopedElement(CalendarRange, {\n    value: value,\n    onChange: onCalendarChange,\n    disablePast: disablePast,\n    disableFuture: disableFuture,\n    shouldDisableDate: shouldDisableDate,\n    onClose: closeCalendar,\n    getRootRef: calendarRef,\n    disablePickers: disablePickers,\n    prevMonthAriaLabel: prevMonthAriaLabel,\n    nextMonthAriaLabel: nextMonthAriaLabel,\n    changeMonthAriaLabel: changeMonthAriaLabel,\n    changeYearAriaLabel: changeYearAriaLabel,\n    changeDayAriaLabel: changeDayAriaLabel\n  })));\n};","map":{"version":3,"mappings":"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","names":["React","format","isMatch","parse","isAfter","Icon16Clear","Icon20CalendarOutline","CalendarRange","Popper","IconButton","useDateInput","useAdaptivity","classNames","multiRef","FormField","InputLike","InputLikeDivider","callMultiple","elementsConfig","index","length","min","max","getInternalValue","value","newValue","String","getDate","padStart","getMonth","getFullYear","DateRangeInput","shouldDisableDate","disableFuture","disablePast","onChange","_ref$calendarPlacemen","calendarPlacement","style","className","_ref$closeOnChange","closeOnChange","disablePickers","getRootRef","name","autoFocus","disabled","onClick","onFocus","prevMonthAriaLabel","nextMonthAriaLabel","changeDayAriaLabel","changeMonthAriaLabel","changeYearAriaLabel","_ref$changeStartDayAr","changeStartDayAriaLabel","_ref$changeStartMonth","changeStartMonthAriaLabel","_ref$changeStartYearA","changeStartYearAriaLabel","_ref$changeEndDayAria","changeEndDayAriaLabel","_ref$changeEndMonthAr","changeEndMonthAriaLabel","_ref$changeEndYearAri","changeEndYearAriaLabel","_ref$clearFieldAriaLa","clearFieldAriaLabel","_ref$showCalendarAria","showCalendarAriaLabel","props","daysStartRef","useRef","monthsStartRef","yearsStartRef","daysEndRef","monthsEndRef","yearsEndRef","onInternalValueChange","useCallback","internalValue","isStartValid","isEndValid","i","formattedStartValue","formattedEndValue","mask","valueExists","Array","isArray","now","Date","start","end","refs","useMemo","maxElement","rootRef","calendarRef","open","openCalendar","closeCalendar","handleKeyDown","setFocusedElement","handleFieldEnter","clear","removeFocusFromField","sizeY","onCalendarChange","createScopedElement","vkuiClass","after","hoverMode","type","onKeyDown","onElementSelect","targetRef","offsetDistance","placement","onClose"],"sources":["C:\\Users\\zpili\\Desktop\\Finbox-VK-mini-apps\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\DateRangeInput\\DateRangeInput.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { format, isMatch, parse, isAfter } from \"date-fns\";\nimport { Icon16Clear, Icon20CalendarOutline } from \"@vkontakte/icons\";\nimport {\n  CalendarRange,\n  CalendarRangeProps,\n} from \"../CalendarRange/CalendarRange\";\nimport { Popper, Placement } from \"../Popper/Popper\";\nimport IconButton from \"../IconButton/IconButton\";\nimport { HasRootRef } from \"../../types\";\nimport { useDateInput } from \"../../hooks/useDateInput\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { classNames } from \"../../lib/classNames\";\nimport { multiRef } from \"../../lib/utils\";\nimport { FormField } from \"../FormField/FormField\";\nimport { InputLike } from \"../InputLike/InputLike\";\nimport { InputLikeDivider } from \"../InputLike/InputLikeDivider\";\nimport { callMultiple } from \"../../lib/callMultiple\";\nimport \"./DateRangeInput.css\";\n\nexport interface DateRangeInputProps\n  extends Omit<React.InputHTMLAttributes<HTMLDivElement>, \"value\" | \"onChange\">,\n    Pick<\n      CalendarRangeProps,\n      | \"disablePast\"\n      | \"disableFuture\"\n      | \"shouldDisableDate\"\n      | \"onChange\"\n      | \"value\"\n      | \"weekStartsOn\"\n      | \"disablePickers\"\n      | \"prevMonthAriaLabel\"\n      | \"nextMonthAriaLabel\"\n      | \"changeMonthAriaLabel\"\n      | \"changeYearAriaLabel\"\n      | \"changeDayAriaLabel\"\n    >,\n    HasRootRef<HTMLDivElement> {\n  calendarPlacement?: Placement;\n  closeOnChange?: boolean;\n  clearFieldAriaLabel?: string;\n  showCalendarAriaLabel?: string;\n  changeStartDayAriaLabel?: string;\n  changeStartMonthAriaLabel?: string;\n  changeStartYearAriaLabel?: string;\n  changeEndDayAriaLabel?: string;\n  changeEndMonthAriaLabel?: string;\n  changeEndYearAriaLabel?: string;\n}\n\nconst elementsConfig = (index: number) => {\n  let length = 2;\n  let min = 1;\n  let max = 0;\n\n  switch (index) {\n    case 0:\n    case 3:\n      max = 31;\n      break;\n    case 1:\n    case 4:\n      max = 12;\n      break;\n    case 2:\n    case 5:\n      max = 2100;\n      min = 1900;\n      length = 4;\n      break;\n  }\n\n  return { length, min, max };\n};\n\nconst getInternalValue = (value: CalendarRangeProps[\"value\"]) => {\n  const newValue = [\"\", \"\", \"\", \"\", \"\", \"\"];\n  if (value?.[0]) {\n    newValue[0] = String(value[0].getDate()).padStart(2, \"0\");\n    newValue[1] = String(value[0].getMonth() + 1).padStart(2, \"0\");\n    newValue[2] = String(value[0].getFullYear()).padStart(4, \"0\");\n  }\n  if (value?.[1]) {\n    newValue[3] = String(value[1].getDate()).padStart(2, \"0\");\n    newValue[4] = String(value[1].getMonth() + 1).padStart(2, \"0\");\n    newValue[5] = String(value[1].getFullYear()).padStart(4, \"0\");\n  }\n  return newValue;\n};\n\nexport const DateRangeInput: React.FC<DateRangeInputProps> = ({\n  shouldDisableDate,\n  disableFuture,\n  disablePast,\n  value,\n  onChange,\n  calendarPlacement = \"bottom-start\",\n  style,\n  className,\n  closeOnChange = true,\n  disablePickers,\n  getRootRef,\n  name,\n  autoFocus,\n  disabled,\n  onClick,\n  onFocus,\n  prevMonthAriaLabel,\n  nextMonthAriaLabel,\n  changeDayAriaLabel,\n  changeMonthAriaLabel,\n  changeYearAriaLabel,\n  changeStartDayAriaLabel = \"Изменить день начала\",\n  changeStartMonthAriaLabel = \"Изменить месяц начала\",\n  changeStartYearAriaLabel = \"Изменить год начала\",\n  changeEndDayAriaLabel = \"Изменить день окончания\",\n  changeEndMonthAriaLabel = \"Изменить месяц окончания\",\n  changeEndYearAriaLabel = \"Изменить год окончания\",\n  clearFieldAriaLabel = \"Очистить поле\",\n  showCalendarAriaLabel = \"Показать календарь\",\n  ...props\n}) => {\n  const daysStartRef = React.useRef<HTMLSpanElement>(null);\n  const monthsStartRef = React.useRef<HTMLSpanElement>(null);\n  const yearsStartRef = React.useRef<HTMLSpanElement>(null);\n  const daysEndRef = React.useRef<HTMLSpanElement>(null);\n  const monthsEndRef = React.useRef<HTMLSpanElement>(null);\n  const yearsEndRef = React.useRef<HTMLSpanElement>(null);\n\n  const onInternalValueChange = React.useCallback(\n    (internalValue: string[]) => {\n      let isStartValid = true;\n      let isEndValid = true;\n      for (let i = 0; i <= 2; i += 1) {\n        if (internalValue[i].length < elementsConfig(i).length) {\n          isStartValid = false;\n        }\n      }\n      for (let i = 3; i <= 5; i += 1) {\n        if (internalValue[i].length < elementsConfig(i).length) {\n          isEndValid = false;\n        }\n      }\n      const formattedStartValue = `${internalValue[0]}.${internalValue[1]}.${internalValue[2]}`;\n      const formattedEndValue = `${internalValue[3]}.${internalValue[4]}.${internalValue[5]}`;\n      const mask = \"dd.MM.yyyy\";\n\n      if (!isMatch(formattedStartValue, mask)) {\n        isStartValid = false;\n      }\n      if (!isMatch(formattedEndValue, mask)) {\n        isEndValid = false;\n      }\n\n      if (!isStartValid && !isEndValid) {\n        return;\n      }\n\n      const valueExists = Array.isArray(value);\n      const now = new Date();\n      const start = isStartValid\n        ? parse(formattedStartValue, mask, (valueExists && value?.[0]) || now)\n        : null;\n      const end = isEndValid\n        ? parse(formattedEndValue, mask, (valueExists && value?.[1]) || now)\n        : null;\n      if (start && end && isAfter(end, start)) {\n        onChange?.([start, end]);\n      }\n    },\n    [onChange, value]\n  );\n\n  const refs = React.useMemo(\n    () => [\n      daysStartRef,\n      monthsStartRef,\n      yearsStartRef,\n      daysEndRef,\n      monthsEndRef,\n      yearsEndRef,\n    ],\n    [\n      daysStartRef,\n      monthsStartRef,\n      yearsStartRef,\n      daysEndRef,\n      monthsEndRef,\n      yearsEndRef,\n    ]\n  );\n\n  const {\n    rootRef,\n    calendarRef,\n    open,\n    openCalendar,\n    closeCalendar,\n    internalValue,\n    handleKeyDown,\n    setFocusedElement,\n    handleFieldEnter,\n    clear,\n    removeFocusFromField,\n  } = useDateInput({\n    maxElement: 5,\n    refs,\n    autoFocus,\n    disabled,\n    elementsConfig,\n    onChange,\n    onInternalValueChange,\n    getInternalValue,\n    value,\n  });\n\n  const { sizeY } = useAdaptivity();\n\n  const onCalendarChange = React.useCallback(\n    (newValue?: Array<Date | null> | undefined) => {\n      onChange?.(newValue);\n      if (closeOnChange && newValue?.[1] && newValue[1] !== value?.[1]) {\n        removeFocusFromField();\n      }\n    },\n    [onChange, closeOnChange, value, removeFocusFromField]\n  );\n\n  return (\n    <FormField\n      vkuiClass={classNames(\"DateRangeInput\", `DateRangeInput--sizeY-${sizeY}`)}\n      style={style}\n      className={className}\n      getRootRef={multiRef(rootRef, getRootRef)}\n      after={\n        value ? (\n          <IconButton\n            hoverMode=\"opacity\"\n            aria-label={clearFieldAriaLabel}\n            onClick={clear}\n          >\n            <Icon16Clear />\n          </IconButton>\n        ) : (\n          <IconButton\n            hoverMode=\"opacity\"\n            aria-label={showCalendarAriaLabel}\n            onClick={openCalendar}\n          >\n            <Icon20CalendarOutline />\n          </IconButton>\n        )\n      }\n      disabled={disabled}\n      onClick={callMultiple(handleFieldEnter, onClick)}\n      onFocus={callMultiple(handleFieldEnter, onFocus)}\n      {...props}\n    >\n      <input\n        type=\"hidden\"\n        name={name}\n        value={\n          value\n            ? `${value[0] ? format(value[0], \"dd.MM.yyyy\") : \"\"} - ${\n                value[1] ? format(value[1], \"dd.MM.yyyy\") : \"\"\n              }`\n            : \"\"\n        }\n      />\n      <span vkuiClass=\"DateInput__input\" onKeyDown={handleKeyDown}>\n        <InputLike\n          length={2}\n          getRootRef={daysStartRef}\n          index={0}\n          onElementSelect={setFocusedElement}\n          value={internalValue[0]}\n          aria-label={changeStartDayAriaLabel}\n        />\n        <InputLikeDivider>.</InputLikeDivider>\n        <InputLike\n          length={2}\n          getRootRef={monthsStartRef}\n          index={1}\n          onElementSelect={setFocusedElement}\n          value={internalValue[1]}\n          aria-label={changeStartMonthAriaLabel}\n        />\n        <InputLikeDivider>.</InputLikeDivider>\n        <InputLike\n          length={4}\n          getRootRef={yearsStartRef}\n          index={2}\n          onElementSelect={setFocusedElement}\n          value={internalValue[2]}\n          aria-label={changeStartYearAriaLabel}\n        />\n        <InputLikeDivider>{\" — \"}</InputLikeDivider>\n        <InputLike\n          length={2}\n          getRootRef={daysEndRef}\n          index={3}\n          onElementSelect={setFocusedElement}\n          value={internalValue[3]}\n          aria-label={changeEndDayAriaLabel}\n        />\n        <InputLikeDivider>.</InputLikeDivider>\n        <InputLike\n          length={2}\n          getRootRef={monthsEndRef}\n          index={4}\n          onElementSelect={setFocusedElement}\n          value={internalValue[4]}\n          aria-label={changeEndMonthAriaLabel}\n        />\n        <InputLikeDivider>.</InputLikeDivider>\n        <InputLike\n          length={4}\n          getRootRef={yearsEndRef}\n          index={5}\n          onElementSelect={setFocusedElement}\n          value={internalValue[5]}\n          aria-label={changeEndYearAriaLabel}\n        />\n      </span>\n      {open && (\n        <Popper\n          targetRef={rootRef}\n          offsetDistance={8}\n          placement={calendarPlacement}\n        >\n          <CalendarRange\n            value={value}\n            onChange={onCalendarChange}\n            disablePast={disablePast}\n            disableFuture={disableFuture}\n            shouldDisableDate={shouldDisableDate}\n            onClose={closeCalendar}\n            getRootRef={calendarRef}\n            disablePickers={disablePickers}\n            prevMonthAriaLabel={prevMonthAriaLabel}\n            nextMonthAriaLabel={nextMonthAriaLabel}\n            changeMonthAriaLabel={changeMonthAriaLabel}\n            changeYearAriaLabel={changeYearAriaLabel}\n            changeDayAriaLabel={changeDayAriaLabel}\n          />\n        </Popper>\n      )}\n    </FormField>\n  );\n};\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}