{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport vkBridge from \"@vkontakte/vk-bridge\";\nimport { canUseDOM, useDOM } from \"../../lib/dom\";\nimport { ConfigProviderContext, WebviewType } from \"./ConfigProviderContext\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { useObjectMemo } from \"../../hooks/useObjectMemo\";\nimport { noop } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { normalizeScheme, Scheme } from \"../../helpers/scheme\";\nimport { AppearanceProvider, generateVKUITokensClassName } from \"../AppearanceProvider/AppearanceProvider\";\nimport { LocaleProviderContext } from \"../LocaleProviderContext/LocaleProviderContext\";\nimport { platform as resolvePlatform } from \"../../lib/platform\";\nvar warn = warnOnce(\"ConfigProvider\");\nfunction useSchemeDetector(node, _scheme) {\n  var inherit = _scheme === \"inherit\";\n  var getScheme = React.useCallback(function () {\n    if (!inherit || !canUseDOM || !node) {\n      return undefined;\n    }\n    return node.getAttribute(\"scheme\");\n  }, [inherit, node]);\n  var _React$useState = React.useState(getScheme()),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    resolvedScheme = _React$useState2[0],\n    setScheme = _React$useState2[1];\n  React.useEffect(function () {\n    if (!inherit || !node) {\n      return noop;\n    }\n    setScheme(getScheme());\n    var observer = new MutationObserver(function () {\n      return setScheme(getScheme());\n    });\n    observer.observe(node, {\n      attributes: true,\n      attributeFilter: [\"scheme\"]\n    });\n    return function () {\n      return observer.disconnect();\n    };\n  }, [getScheme, inherit, node]);\n  return _scheme === \"inherit\" ? resolvedScheme : _scheme;\n}\nvar deriveAppearance = function deriveAppearance(scheme) {\n  return scheme === Scheme.SPACE_GRAY || scheme === Scheme.VKCOM_DARK ? \"dark\" : \"light\";\n};\nvar ConfigProvider = function ConfigProvider(_ref) {\n  var children = _ref.children,\n    _ref$webviewType = _ref.webviewType,\n    webviewType = _ref$webviewType === void 0 ? WebviewType.VKAPPS : _ref$webviewType,\n    _ref$isWebView = _ref.isWebView,\n    isWebView = _ref$isWebView === void 0 ? vkBridge.isWebView() : _ref$isWebView,\n    _ref$transitionMotion = _ref.transitionMotionEnabled,\n    transitionMotionEnabled = _ref$transitionMotion === void 0 ? true : _ref$transitionMotion,\n    _ref$platform = _ref.platform,\n    platform = _ref$platform === void 0 ? resolvePlatform() : _ref$platform,\n    _ref$hasNewTokens = _ref.hasNewTokens,\n    hasNewTokens = _ref$hasNewTokens === void 0 ? false : _ref$hasNewTokens,\n    appearance = _ref.appearance,\n    scheme = _ref.scheme,\n    _ref$locale = _ref.locale,\n    locale = _ref$locale === void 0 ? \"ru\" : _ref$locale;\n  var normalizedScheme = normalizeScheme({\n    scheme: scheme,\n    platform: platform,\n    appearance: appearance\n  });\n  var _useDOM = useDOM(),\n    document = _useDOM.document;\n  var target = document === null || document === void 0 ? void 0 : document.body;\n  useIsomorphicLayoutEffect(function () {\n    if (normalizedScheme === \"inherit\") {\n      return noop;\n    }\n    if (process.env.NODE_ENV === \"development\" && target !== null && target !== void 0 && target.hasAttribute(\"scheme\")) {\n      warn('<body scheme> was set before VKUI mount - did you forget scheme=\"inherit\"?');\n    }\n    target === null || target === void 0 ? void 0 : target.setAttribute(\"scheme\", normalizedScheme);\n    return function () {\n      return target === null || target === void 0 ? void 0 : target.removeAttribute(\"scheme\");\n    };\n  }, [normalizedScheme]);\n  var realScheme = useSchemeDetector(target, normalizedScheme);\n  var derivedAppearance = deriveAppearance(realScheme);\n  useIsomorphicLayoutEffect(function () {\n    var VKUITokensClassName = generateVKUITokensClassName(platform, derivedAppearance);\n    target === null || target === void 0 ? void 0 : target.classList.add(VKUITokensClassName);\n    return function () {\n      target === null || target === void 0 ? void 0 : target.classList.remove(VKUITokensClassName);\n    };\n  }, [platform, derivedAppearance]);\n  var configContext = useObjectMemo({\n    webviewType: webviewType,\n    isWebView: isWebView,\n    transitionMotionEnabled: transitionMotionEnabled,\n    hasNewTokens: hasNewTokens,\n    platform: platform,\n    scheme: scheme,\n    appearance: appearance || derivedAppearance\n  });\n  return createScopedElement(ConfigProviderContext.Provider, {\n    value: configContext\n  }, createScopedElement(LocaleProviderContext.Provider, {\n    value: locale\n  }, createScopedElement(AppearanceProvider, {\n    appearance: configContext.appearance\n  }, children)));\n}; // eslint-disable-next-line import/no-default-export\n\nexport default ConfigProvider;","map":{"version":3,"mappings":"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","names":["React","vkBridge","canUseDOM","useDOM","ConfigProviderContext","WebviewType","useIsomorphicLayoutEffect","useObjectMemo","noop","warnOnce","normalizeScheme","Scheme","AppearanceProvider","generateVKUITokensClassName","LocaleProviderContext","platform","resolvePlatform","warn","useSchemeDetector","node","_scheme","inherit","getScheme","useCallback","undefined","getAttribute","useState","_React$useState2","resolvedScheme","setScheme","useEffect","observer","MutationObserver","observe","attributes","attributeFilter","disconnect","deriveAppearance","scheme","SPACE_GRAY","VKCOM_DARK","ConfigProvider","children","_ref$webviewType","webviewType","VKAPPS","_ref$isWebView","isWebView","_ref$transitionMotion","transitionMotionEnabled","_ref$platform","_ref$hasNewTokens","hasNewTokens","appearance","_ref$locale","locale","normalizedScheme","document","target","body","process","env","NODE_ENV","hasAttribute","setAttribute","removeAttribute","realScheme","derivedAppearance","VKUITokensClassName","classList","add","remove","configContext","createScopedElement","Provider","value"],"sources":["C:\\Users\\zpili\\Desktop\\Finbox-VK-mini-apps\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\ConfigProvider\\ConfigProvider.tsx"],"sourcesContent":["import * as React from \"react\";\nimport vkBridge, { AppearanceType } from \"@vkontakte/vk-bridge\";\nimport { canUseDOM, useDOM } from \"../../lib/dom\";\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n  WebviewType,\n} from \"./ConfigProviderContext\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { useObjectMemo } from \"../../hooks/useObjectMemo\";\nimport { noop } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport {\n  normalizeScheme,\n  AppearanceScheme,\n  Scheme,\n} from \"../../helpers/scheme\";\nimport {\n  AppearanceProvider,\n  generateVKUITokensClassName,\n} from \"../AppearanceProvider/AppearanceProvider\";\nimport { LocaleProviderContext } from \"../LocaleProviderContext/LocaleProviderContext\";\nimport { platform as resolvePlatform } from \"../../lib/platform\";\n\nexport interface ConfigProviderProps\n  extends Partial<ConfigProviderContextInterface> {\n  /**\n   * @deprecated будет удалено в 5.0.0, устанавливать тему следует через appearance\n   * Цветовая схема приложения\n   */\n  scheme?: AppearanceScheme;\n  /**\n    Локаль ([список](https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry))\n   */\n  locale?: string;\n}\n\nconst warn = warnOnce(\"ConfigProvider\");\n\nfunction useSchemeDetector(\n  node: HTMLElement | undefined | null,\n  _scheme: Scheme | \"inherit\"\n) {\n  const inherit = _scheme === \"inherit\";\n  const getScheme = React.useCallback(() => {\n    if (!inherit || !canUseDOM || !node) {\n      return undefined;\n    }\n    return node.getAttribute(\"scheme\") as Scheme;\n  }, [inherit, node]);\n  const [resolvedScheme, setScheme] = React.useState(getScheme());\n\n  React.useEffect(() => {\n    if (!inherit || !node) {\n      return noop;\n    }\n    setScheme(getScheme());\n    const observer = new MutationObserver(() => setScheme(getScheme()));\n    observer.observe(node, { attributes: true, attributeFilter: [\"scheme\"] });\n    return () => observer.disconnect();\n  }, [getScheme, inherit, node]);\n\n  return _scheme === \"inherit\" ? resolvedScheme : _scheme;\n}\n\nconst deriveAppearance = (scheme: Scheme | undefined): AppearanceType =>\n  scheme === Scheme.SPACE_GRAY || scheme === Scheme.VKCOM_DARK\n    ? \"dark\"\n    : \"light\";\n\nconst ConfigProvider: React.FC<ConfigProviderProps> = ({\n  children,\n  webviewType = WebviewType.VKAPPS,\n  isWebView = vkBridge.isWebView(),\n  transitionMotionEnabled = true,\n  platform = resolvePlatform(),\n  hasNewTokens = false,\n  appearance,\n  scheme,\n  locale = \"ru\",\n}) => {\n  const normalizedScheme = normalizeScheme({\n    scheme,\n    platform,\n    appearance,\n  });\n  const { document } = useDOM();\n  const target = document?.body;\n\n  useIsomorphicLayoutEffect(() => {\n    if (normalizedScheme === \"inherit\") {\n      return noop;\n    }\n    if (\n      process.env.NODE_ENV === \"development\" &&\n      target?.hasAttribute(\"scheme\")\n    ) {\n      warn(\n        '<body scheme> was set before VKUI mount - did you forget scheme=\"inherit\"?'\n      );\n    }\n    target?.setAttribute(\"scheme\", normalizedScheme);\n    return () => target?.removeAttribute(\"scheme\");\n  }, [normalizedScheme]);\n\n  const realScheme = useSchemeDetector(target, normalizedScheme);\n  const derivedAppearance = deriveAppearance(realScheme);\n\n  useIsomorphicLayoutEffect(() => {\n    const VKUITokensClassName = generateVKUITokensClassName(\n      platform,\n      derivedAppearance\n    );\n\n    target?.classList.add(VKUITokensClassName);\n\n    return () => {\n      target?.classList.remove(VKUITokensClassName);\n    };\n  }, [platform, derivedAppearance]);\n\n  const configContext = useObjectMemo({\n    webviewType,\n    isWebView,\n    transitionMotionEnabled,\n    hasNewTokens,\n    platform,\n    scheme,\n    appearance: appearance || derivedAppearance,\n  });\n\n  return (\n    <ConfigProviderContext.Provider value={configContext}>\n      <LocaleProviderContext.Provider value={locale}>\n        <AppearanceProvider appearance={configContext.appearance}>\n          {children}\n        </AppearanceProvider>\n      </LocaleProviderContext.Provider>\n    </ConfigProviderContext.Provider>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\nexport default ConfigProvider;\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}